var documenterSearchIndex = {"docs":
[{"location":"nnm.html#Nitrate-Network-Model","page":"Basic Model","title":"Nitrate Network Model","text":"","category":"section"},{"location":"nnm.html#Function-documentation","page":"Basic Model","title":"Function documentation","text":"","category":"section"},{"location":"nnm.html","page":"Basic Model","title":"Basic Model","text":"StreamModel\nStreamModel(::String, ::String)\nevaluate!(::StreamModel)\nsave_model_results","category":"page"},{"location":"nnm.html#NitrateNetworkModel.StreamModel","page":"Basic Model","title":"NitrateNetworkModel.StreamModel","text":"StreamModel(\n    mc::ModelConstants,\n    nc::NetworkConstants,\n    mv::ModelVariables\n)\n\nThe StreamModel structure is a wrapper around three other structures. ModelConstants holds values of physical and process constants that do not change during the run. NetworkConstants holds the specification of the links, their characteristics, and nitrate concentrations from the landscape. It will not change during the run, but is expected to be adapted for each management scenario. Finally, ModelVariables holds the values that are calculated during the model run. All NitrateNetworkModel functions will take the entire StreamModel as an argument, so there is no need to pull out the component structures. It is also expected that users will use the file-based constructor StreamModel(::String, ::String).\n\n\n\n\n\n","category":"type"},{"location":"nnm.html#NitrateNetworkModel.StreamModel-Tuple{String, String}","page":"Basic Model","title":"NitrateNetworkModel.StreamModel","text":"StreamModel(baseparams_file::String, network_file::String)\n\nConstructs a StreamModel based on inputs in two csv files. The files should be structured as follows:\n\nbaseparams_file: columns \"variable\" and \"value\".\nnetwork_file: many more columns.\n\n\n\n\n\n","category":"method"},{"location":"nnm.html#NitrateNetworkModel.evaluate!-Tuple{StreamModel}","page":"Basic Model","title":"NitrateNetworkModel.evaluate!","text":"evaluate!(model::StreamModel; qgage::Float64, contrib_n_load_reduction::Union{nothing,Array{Float64,1}})\n\nMain model function. Assumes that model.nc has already been updated to reflect the desired management scenario, e.g. updates to model.nc.contrib_n_load_factor or model.nc.feature and model.nc.wetland_area.\n\nIf a value for qgage is provided, the model will be run using that value as the flow measured at the link model.nc.gage_link, which is used to assign flow values to all other links. Otherwise, the model will be run using model.nc.gage_flow.\n\n#TODO: the reason I'm doing it this way is because the nc struct is currently immutable. I could switch it to mutable, but I've been avoiding that due to potential performance regressions. I should test that, since this is introduces a funny asymmetry in how different model parameters are handled. \n\n\n\n\n\n","category":"method"},{"location":"nnm.html#NitrateNetworkModel.save_model_results","page":"Basic Model","title":"NitrateNetworkModel.save_model_results","text":"save_model_results(model::StreamModel, filename::String)\n\nWrites model results to csv file\n\n\n\n\n\n","category":"function"},{"location":"nnm.html#Results-access","page":"Basic Model","title":"Results access","text":"","category":"section"},{"location":"nnm.html","page":"Basic Model","title":"Basic Model","text":"These functions give ways of extracting key results from the model structure.","category":"page"},{"location":"nnm.html","page":"Basic Model","title":"Basic Model","text":"get_outlet_nconc\nget_avg_nconc\nget_delivery_ratios","category":"page"},{"location":"nnm.html#NitrateNetworkModel.get_outlet_nconc","page":"Basic Model","title":"NitrateNetworkModel.get_outlet_nconc","text":"get_outlet_nconc(model::StreamModel)::Float64\n\nGets nitrate concentration leaving outlet link\n\n\n\n\n\n","category":"function"},{"location":"nnm.html#NitrateNetworkModel.get_delivery_ratios","page":"Basic Model","title":"NitrateNetworkModel.get_delivery_ratios","text":"get_delivery_ratios(model::StreamModel)::Tuple{Vector{Float64}, Vector{Float64}}\n\nReturns vectors with net delivery ratio and escape fraction for each link.\n\n\n\n\n\n","category":"function"},{"location":"sub_networks.html#Subnetworks","page":"Subnetworks","title":"Subnetworks","text":"","category":"section"},{"location":"sub_networks.html","page":"Subnetworks","title":"Subnetworks","text":"Functions to pull out sub-models from full models. Intended for use in testing or when there's an interest in a subregion.","category":"page"},{"location":"sub_networks.html#Usage","page":"Subnetworks","title":"Usage","text":"","category":"section"},{"location":"sub_networks.html","page":"Subnetworks","title":"Subnetworks","text":"Define a SubNetworkDef struct, then call generate_subnetwork. Once this is done, StreamModel and FlowRegime structs can be created directly from the SubNetworkDef struct","category":"page"},{"location":"sub_networks.html#Documentation","page":"Subnetworks","title":"Documentation","text":"","category":"section"},{"location":"sub_networks.html","page":"Subnetworks","title":"Subnetworks","text":"SubNetworkDef\ngenerate_subnetwork\nStreamModel(::SubNetworkDef)\nFlowRegime(::SubNetworkDef)","category":"page"},{"location":"sub_networks.html#NitrateNetworkModel.SubNetworkDef","page":"Subnetworks","title":"NitrateNetworkModel.SubNetworkDef","text":"SubNetworkDef(\n    network_file::String,\n    baseparams_file::String,\n    flow_regime_file::String,\n    root_node::Int,\n    subnetwork_file::String,\n    subnetwork_params_file::String,\n    subnetwork_flow_regime_file::Union{Nothing, String}\n)\n\nParametric struct to pass to generate_subnetwork. \n\nThe final argument, subnetwork_flow_regime_file can be nothing or a path to a  flow regime file. If it points to a file, a corresponding scaled flow regime file will be created, or if it is nothing, this will be skipped.\n\nAll other arguments are required.\n\n\n\n\n\n","category":"type"},{"location":"sub_networks.html#NitrateNetworkModel.generate_subnetwork","page":"Subnetworks","title":"NitrateNetworkModel.generate_subnetwork","text":"generate_subnetwork(subnetworkdef::SubNetworkDef)\n\nGenerate files for running the NitrateNetworkModel on a subnetwork of a larger network model. \n\n\n\n\n\n","category":"function"},{"location":"sub_networks.html#NitrateNetworkModel.StreamModel-Tuple{SubNetworkDef}","page":"Subnetworks","title":"NitrateNetworkModel.StreamModel","text":"StreamModel(subnetworkdef::SubNetworkDef)\n\nConstruct a StreamModel from a SubNetworkDef\n\n\n\n\n\n","category":"method"},{"location":"sub_networks.html#NitrateNetworkModel.FlowRegime-Tuple{SubNetworkDef}","page":"Subnetworks","title":"NitrateNetworkModel.FlowRegime","text":"FlowRegime(subnetworkdef::SubNetworkDef)\n\nConstruct a FlowRegime from a SubNetworkDef\n\n\n\n\n\n","category":"method"},{"location":"index.html#Documentation-for-NitrateNetworkModel","page":"Home","title":"Documentation for NitrateNetworkModel","text":"","category":"section"},{"location":"index.html","page":"Home","title":"Home","text":"This module implements the Nitrate Network Model described in Czuba, et al. (2018).","category":"page"},{"location":"index.html#Basic-usage","page":"Home","title":"Basic usage","text":"","category":"section"},{"location":"index.html","page":"Home","title":"Home","text":"Basic usage requires two files, one that defines model parameters and another that defines the stream network to be simulated. In the example below, these are base_params.csv and network_table.csv. Construct a StreamModel, and then evaluate!() it to run the model.","category":"page"},{"location":"index.html","page":"Home","title":"Home","text":"using NitrateNetworkModel\n\nsm = StreamModel(\n    \"../data/base_params.csv\", \n    \"../data/network_table.csv\"\n)\nevaluate!(sm)\nsave_model_results(sm, \"../results/base_results.csv\")","category":"page"},{"location":"flow_regime.html#Flow-Regime","page":"Flow Regime","title":"Flow Regime","text":"","category":"section"},{"location":"flow_regime.html","page":"Flow Regime","title":"Flow Regime","text":"Functions to allow the basic StreamModel to be run across a range of flow values, and estimate frequency curves for nitrate concentrations based on the frequency curves for flow.","category":"page"},{"location":"flow_regime.html#Function-documentation","page":"Flow Regime","title":"Function documentation","text":"","category":"section"},{"location":"flow_regime.html","page":"Flow Regime","title":"Flow Regime","text":"FlowRegime\nFlowRegime(flowfile::String; q_gage_col, p_exceed_col, p_mass_col)\nevaluate!(::StreamModel, ::FlowRegime)\nFlowRegimeSimResults\nweighted_outlet_nconc(::FlowRegimeSimResults)\nweighted_avg_nconc(::FlowRegimeSimResults)","category":"page"},{"location":"flow_regime.html#NitrateNetworkModel.FlowRegime","page":"Flow Regime","title":"NitrateNetworkModel.FlowRegime","text":"FlowRegime(\n    q_gage::Vector{Float64},\n    p_exceed::Vector{Float64},\n    p_mass::Vector{Float64}\n)\n\nInput structure for evaluating StreamModel against multiple flow values. Single-link flow regime - values measured at gaged link.\n\n\n\n\n\n","category":"type"},{"location":"flow_regime.html#NitrateNetworkModel.FlowRegime-Tuple{String}","page":"Flow Regime","title":"NitrateNetworkModel.FlowRegime","text":"FlowRegime(flowfile::String; q_gage_col=:Q, p_exceed_col=:cp, p_mass_col=:cf)\n\nConstructor function to build FlowRegime from csv file.\n\n\n\n\n\n","category":"method"},{"location":"flow_regime.html#NitrateNetworkModel.evaluate!-Tuple{StreamModel, FlowRegime}","page":"Flow Regime","title":"NitrateNetworkModel.evaluate!","text":"evaluate!(model::StreamModel, flowregime::FlowRegime)\n\nRuns stream_model.evaluate!(model, q) for each q in flowregime.q_gage. Outlet and average concentrations are saved to a FlowRegimeSimResults struct and returned.\n\n\n\n\n\n","category":"method"},{"location":"flow_regime.html#NitrateNetworkModel.FlowRegimeSimResults","page":"Flow Regime","title":"NitrateNetworkModel.FlowRegimeSimResults","text":"FlowRegimeSimResults(\n    n_conc_outlet::Vector{Float64},\n    n_conc_avg::Vector{Float64},\n    p_mass::Vector{Float64}\n)\n\nResults structure returned by evaluate!. Contains outlet and average nitrate concentration values for each of the flow values in flowregime.q_gage. flowregime.p_mass is copied over for convenience.\n\n\n\n\n\n","category":"type"},{"location":"flow_regime.html#NitrateNetworkModel.weighted_outlet_nconc-Tuple{FlowRegimeSimResults}","page":"Flow Regime","title":"NitrateNetworkModel.weighted_outlet_nconc","text":"weighted_outlet_nconc(results::FlowRegimeSimResults)\n\nConvenience function for getting probability exceedance weighted outlet concentration.\n\n\n\n\n\n","category":"method"},{"location":"flow_regime.html#NitrateNetworkModel.weighted_avg_nconc-Tuple{FlowRegimeSimResults}","page":"Flow Regime","title":"NitrateNetworkModel.weighted_avg_nconc","text":"weighted_avg_nconc(results::FlowRegimeSimResults)\n\nConvenience function for getting probability exceedance weighted average concentration.\n\n\n\n\n\n","category":"method"},{"location":"flow_regime.html#Example","page":"Flow Regime","title":"Example","text":"","category":"section"},{"location":"flow_regime.html","page":"Flow Regime","title":"Flow Regime","text":"using NitrateNetworkModel\nusing Plots\nusing Printf\n\n# required input files\nbaseparams_file = \"../data/baseparams.csv\"\nnetwork_file = \"../data/network_table.csv\"\nflowfile = \"../data/flow_values.csv\"\n\n# create the model structs\nsm = StreamModel(baseparams_file, network_file)\nfr = FlowRegime(flowfile)\n\n# run the model\nresults = evaluate!(sm, fr)\n\n# create a summary figure\nplot(fr.p_exceed, results.n_conc_outlet,\n    label=@sprintf \"Outlet (overall: %.2f)\" weighted_outlet_nconc(results))\nplot!(fr.p_exceed, results.n_conc_avg,\n    label=@sprintf \"Average (overall: %.2f)\" weighted_avg_nconc(results))\nxaxis!(\"Probability Exceedance\")\nyaxis!(\"Nitrate Concentration\")","category":"page"}]
}
